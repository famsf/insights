{% macro id(chapter) %}
  {{- chapter.id|default('chapter' ~ chapter.index) -}}
{% endmacro %}
{% import _self as get %}
{% set id = get.id(_context) %}

<section class="chapter {{ classes }}" id="{{ id }}" data-chapter-index="{{ index }}" data-chapter-length="{{ pages|length }}">
  {% for page in pages %}
    {# Use "passthrough" to send chapter/story data to CoverPage + chapter__title. #}
    {# On CoverPage, use the story title instead of chapter title. #}
    {% set isFirstPageOfChapter = loop.first %}
    {% set isCoverPage = index == 0 %}
    {%
      include "@organisms/Page/Page.html.twig" with page|merge({
        index: loop.index0,
        chapter: id,
        passthrough: isFirstPageOfChapter ? {
          title: isCoverPage ? story : title,
          numeral: numeral,
        } : {},
      }) only
    %}
  {% endfor %}
</section>
