{# Set the default image style #}
{% if (style is not defined or style == '') %}
  {% set style = 'default' %}
{% endif %}
{# Include the image style #}
{% extends "@image-style/" ~ style ~ "/" ~ style ~ ".twig" %}
{# Calculate what quality should be used #}
{% import "@macros/ci-quality.html.twig" as ci %}

{# Set the CloudImage sizes and type as defined by the image style #}
{% block ci_variables %}

  {% set sizes = default_image_sizes %}
  {% set type = default_image_type %}

  {# Strip the ? params from the file names #}
  {% set newsrc = src|split("?") %}
  {% set outsrc = newsrc[0] %}
  <img
    class="{{ classes }}"
    alt="{{ alt }}"
    width="{{ width }}"
    height="{{ height }}"
    src="{{ outsrc }}.jpg"
    ci-responsive
    ci-src="{{ outsrc }}.jpg"
    ci-params="{{ ci.quality(outsrc, quality) }}"
    {% if type %}
      ci-type="{{ type }}"
    {% endif %}
    {% if sizes %}
      ci-size="{{ sizes }}"
    {% endif %}
  >

{% endblock %}
