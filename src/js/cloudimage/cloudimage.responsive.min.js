/* eslint-disable */!function(window,document){function getSizeLimit(e){return e<=25?"25":e<=50?"50":e<=100?"100":e<=200?"200":e<=300?"300":e<=400?"400":e<=500?"500":e<=600?"600":e<=700?"700":e<=800?"800":e<=900?"900":e<=1e3?"1000":e<=1100?"1100":e<=1200?"1200":e<=1300?"1300":e<=1400?"1400":e<=1500?"1500":e<=1600?"1600":e<=1700?"1700":e<=1800?"1800":e<=1900?"1900":e<=2400?"2400":e<=2800?"2800":"3600"}function onerrorImg(e){}function getParentContainerWithWidth(e){var i=null,t=0;do{t=(i=i&&i.parentNode||e.parentNode).getBoundingClientRect().width}while(i&&!t);return t}function filterImages(e,i){for(var t=[],r=0;r<e.length;r++){var n=e[r];".svg"!==(n.getAttribute(i)||"").slice(-4).toLowerCase()&&t.push(n)}return t}var resizeTimer;Array.prototype.forEach||(Array.prototype.forEach=function(e){var i,t;if(null==this)throw new TypeError("this is null or not defined");var r=Object(this),n=r.length>>>0;if("function"!=typeof e)throw new TypeError(e+" is not a function");for(arguments.length>1&&(i=arguments[1]),t=0;t<n;){var s;t in r&&(s=r[t],e.call(i,s,t,r)),t++}}),[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(e){e.hasOwnProperty("remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){null!==this.parentNode&&this.parentNode.removeChild(this)}})}),window.jScaler=window.jScaler||{},jScaler.setConfig=function(e){e=e||{},jScaler.config={IS_ULTRA_FAST:e.IS_ULTRA_FAST||!1,TOKEN:e.TOKEN||"",CONTAINER:e.CONTAINER||".cloudimg.io",DEFAULT_WIDTH:e.DEFAULT_WIDTH||"400",DEFAULT_HEIGHT:e.DEFAULT_HEIGHT||"300",DEFAULT_TYPE:e.DEFAULT_TYPE||"width",DEFAULT_PARAMS:e.DEFAULT_PARAMS||"none",BASE_URL:e.BASE_URL||"/",PRESETS:e.PRESETS||{xs:576,sm:768,md:992,lg:1200,xl:1920},ORDER:e.ORDER||["xl","lg","md","sm","xs"],AUTO:e.AUTO||[1920,1200,992,768,576],QUERY_STRING:e.QUERY_STRING||""}},jScaler.init=function(){this.backgroundImgIndex=0,this.head=document.head||document.getElementsByTagName("head")[0],"trunc"in Math||(Math.trunc=Math.floor)},jScaler.process=function(e){this.setConfig(e);var i=filterImages(document.querySelectorAll("img[ci-src]"),"ci-src"),t=filterImages(document.querySelectorAll("[ci-img-background]"),"ci-img-background");i.length>0&&(i=Array.prototype.slice.call(i),[].forEach.call(i,function(e){this.attr(e,"src")?this.processImage(e,!0):this.processImage(e)},this)),t.length>0&&(t=Array.prototype.slice.call(t),[].forEach.call(t,function(e){this.attr(e,"ci-img-index")>=0&&this.processBackgroundImage(e)},this))},jScaler.getParentWidth=function(e){if(!(e&&e.parentElement&&e.parentElement.getBoundingClientRect||e&&e.width))return jScaler.config.DEFAULT_WIDTH;var i=getParentContainerWithWidth(e),t=parseInt(i,10),r=Number(window.getComputedStyle(e).width);return r&&r<t&&r>15||!t?getSizeLimit(r):t?getSizeLimit(t):e.width||jScaler.config.DEFAULT_WIDTH},jScaler.getElementSize=function(e,i){return e&&e.getBoundingClientRect?getSizeLimit(parseInt(e.getBoundingClientRect()[i],10)):null},jScaler.checkOnMedia=function(size){try{var object=eval("("+size+")");return object&&"object"==typeof object}catch(e){return!1}},jScaler.processImage=function(img,isUpdate){var sourceUrl="ci-src",imgType=this.attr(img,"ci-type")||this.config.DEFAULT_TYPE||"",imgSize=this.attr(img,"ci-size")||this.getParentWidth(img)||"",imgParams=this.attr(img,"ci-params")||this.config.DEFAULT_PARAMS||"",isLocalUrl=this.isLocalURL(img,sourceUrl),isResponsive=this.checkOnMedia(imgSize),imgSrc=this.getImgSrc(img,sourceUrl,isLocalUrl),cloudimageUrl,oldSize=img.getAttribute("data-old-ci-size");if(!(oldSize&&isUpdate&&imgSize&&parseInt(imgSize)<=parseInt(oldSize)))if(img.setAttribute("data-old-ci-size",imgSize),isResponsive?(imgSize=eval("("+imgSize+")"),cloudimageUrl=this.generateUrl("width",this.updateSizeWithPixelRatio(this.getParentWidth(img)),imgParams,imgSrc)):cloudimageUrl=this.generateUrl(imgType,this.updateSizeWithPixelRatio(imgSize),imgParams,imgSrc),isUpdate){var wrapper=img.parentNode.parentNode,sources=wrapper.querySelectorAll("source");[].forEach.call(sources,function(e){e.remove()}),img.setAttribute("src",cloudimageUrl),this.addSources(img,imgType,imgSize,imgParams,imgSrc,isResponsive)}else this.wrap(img),img.setAttribute("src",cloudimageUrl),this.addSources(img,imgType,imgSize,imgParams,imgSrc,isResponsive)},jScaler.updateSizeWithPixelRatio=function(e){var i=e.toString().split("x"),t=[];return[].forEach.call(i,function(e){t.push(e*parseInt(window.devicePixelRatio||1))}),t.join("x")},jScaler.processBackgroundImage=function(e){var i=this.attr(e,"ci-type")||this.config.DEFAULT_TYPE||"",t=this.attr(e,"ci-size")||this.setSizeFromElemProperty(e,i)||this.getDefaultSize(i),r=this.checkOnMedia(t),n=this.attr(e,"ci-params")||this.config.DEFAULT_PARAMS||"",s=this.getBackgroundImgUrl(e,"ci-img-background"),a=e.getAttribute("ci-img-index"),c=null,o=e.getAttribute("data-old-ci-size");o&&t&&parseInt(t)<=parseInt(o)||(e.setAttribute("data-old-ci-size",t),a>=0&&null!==a?c=a:(c=this.backgroundImgIndex.toString(),e.setAttribute("ci-img-index",c),this.backgroundImgIndex++),this.addCss(e,i,t,n,s,r,c))},jScaler.generateUrl=function(e,i,t,r){return(this.config.IS_ULTRA_FAST?"https://scaleflex.ultrafast.io/":"https://")+this.config.TOKEN+this.config.CONTAINER+"/"+e+"/"+i+"/"+t+"/"+r+this.config.QUERY_STRING},jScaler.addSources=function(e,i,t,r,n,s){if(s){var a=[];for(c=0;c<this.config.ORDER.length;c++){t[this.config.ORDER[c]]&&a.unshift(this.config.ORDER[c])}for(var c=0;c<a.length;c++){var o=!(c<a.length-1),l=o?a[c-1]:a[c],g=t[a[c]],d=this.generateSrcset(i,g,r,n),m="("+(o?"min":"max")+"-width: "+(this.config.PRESETS[l]+(o?1:0))+"px)";this.before(e,'<source media="'+m+'" srcset="'+d+'">')}}else this.before(e,'<source srcset="'+this.generateSrcset(i,t,r,n)+'">')},jScaler.getImgSrc=function(e,i,t){var r=this.attr(e,i);return t&&(e.setAttribute("ci-local-url",r),r=this.config.BASE_URL+r),r},jScaler.getBackgroundImgUrl=function(e,i){var t,r=this.attr(e,i)||"";return r||this.setUrlFromElemProperty(e,i),t=this.isLocalURL(e,i),r=this.getImgSrc(e,i,t)},jScaler.generateImgSrc=function(e,i,t,r,n,s){var a=Math.trunc(r*s);return n&&(a+="x"+Math.trunc(n*s)),this.generateUrl(e,this.updateSizeWithPixelRatio(a),i,t).replace("http://scaleflex.ultrafast.io/","").replace("https://scaleflex.ultrafast.io/","").replace("//scaleflex.ultrafast.io/","").replace("///","/")},jScaler.generateSrcset=function(e,i,t,r){var n=i.toString().split("x")[0],s=i.toString().split("x")[1];return this.generateImgSrc(e,t,r,n,s,1)},jScaler.generateMediaQueries=function(e,i,t,r,n,s,a,c,o){var l=this.attr(e,"ci-selector-suffix")||"",g='[ci-img-index="'+this.attr(e,"ci-img-index")+'"]'+l,d=this.attr(e,"ci-important")?" !important":"",m=t.toString().split("x")[0],h=t.toString().split("x")[1],u=s?"} ":"";return(s?"@media ("+(c?"min":"max")+"-width: "+(c?o:a)+"px) {":"")+g+" { background-image: url("+this.generateImgSrc(i,r,n,m,h,1)+")"+d+"; } "+u},jScaler.getDefaultSize=function(e){var i="";switch(e){case"width":i=this.config.DEFAULT_WIDTH;break;case"height":i=this.config.DEFAULT_HEIGHT;break;case"crop":case"fit":case"cover":case"bound":default:i=this.config.DEFAULT_WIDTH+"x"+this.config.DEFAULT_HEIGHT}return i},jScaler.setUrlFromElemProperty=function(e,i){e.setAttribute(i,window.getComputedStyle(e).backgroundImage.slice(5,-2))},jScaler.setSizeFromElemProperty=function(e,i){var t=Number(window.getComputedStyle(e).width),r=Number(window.getComputedStyle(e).height);return t||(t=this.getParentWidth(e)),"width"===i?this.getElementSize(e,"width"):"width"===i?this.getElementSize(e,"height"):t&&r?t+"x"+r:void 0},jScaler.addCss=function(elem,imgType,imgSize,imgParams,imgSrc,isResponsive,nextIndex){var i,size,mediaQuery;if(isResponsive){var cssQueries="";if("full_screen"===imgSize||""===imgSize||null===this.attr(elem,"ci-size"))for(i=0;i<this.config.AUTO.length;i++)imgSize=this.config.AUTO[i],cssQueries+=this.generateMediaQueries(elem,"width",imgSize,imgParams,imgSrc,isResponsive,imgSize);else if(this.checkOnMedia(imgSize)){imgSize=eval("("+imgSize+")");var orderFiltered=[];for(i=0;i<this.config.ORDER.length;i++)size=imgSize[this.config.ORDER[i]],size&&orderFiltered.push(this.config.ORDER[i]);for(i=0;i<orderFiltered.length;i++){var isFirst=0===i,prevSize=isFirst&&orderFiltered[i+1],prevMediaQuery=isFirst&&this.config.PRESETS[prevSize];size=imgSize[orderFiltered[i]],mediaQuery=this.config.PRESETS[this.config.ORDER[i]],cssQueries+=this.generateMediaQueries(elem,imgType,size,imgParams,imgSrc,isResponsive,mediaQuery,isFirst,prevMediaQuery)}}this.addStyles(cssQueries,nextIndex)}else this.addStyles(this.generateMediaQueries(elem,imgType,imgSize,imgParams,imgSrc,isResponsive),nextIndex)},jScaler.addStyles=function(e,i){var t=document.querySelector(".ci-img-index_"+i);t||((t=document.createElement("style")).classList.add("ci-img-index_"+i),t.type="text/css",t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e)),this.head.appendChild(t)),t.innerHTML=e},jScaler.isLocalURL=function(e,i){var t=this.attr(e,i)||"";return 0===t.indexOf("//")&&(t=window.location.protocol+t,e.setAttribute(i,t)),0!==t.indexOf("http://")&&0!==t.indexOf("https://")&&0!==t.indexOf("//")},jScaler.wrap=function(e,i){return i=i||document.createElement("picture"),e.nextSibling?e.parentNode.insertBefore(i,e.nextSibling):e.parentNode.appendChild(i),i.appendChild(e)},jScaler.before=function(e,i){var t,r=document.createElement("template");"content"in r?(r.innerHTML=i,e.parentNode.insertBefore(r.content.firstChild,e)):((t=document.createElement("div")).innerHTML=i,e.parentNode.insertBefore(t.firstChild,e))},jScaler.attr=function(e,i){return e.getAttribute(i)},jScaler.init(),window.addEventListener("resize",function(){clearTimeout(resizeTimer),resizeTimer=setTimeout(function(){jScaler.process(jScaler.config)},350)})}(window,document),function(e){!(window.JolipageEditor&&window.JolipageEditor.init)&&e&&e.process({TOKEN:"scaleflex",DEFAULT_PARAMS:"q80.foil1"})}(jScaler);
